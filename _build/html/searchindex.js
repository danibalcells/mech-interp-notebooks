Search.setIndex({"docnames": ["00-basic-concepts/01-fourier-transform", "01-grokking-modular-addition/01-grokking-modular-addition", "02-thoughts-essays/2023-02-24-klara-and-the-sun", "03-sae/sae", "04-cognitive-biases/cognitive-biases", "05-superposition/smaller-models-of-superposition", "README", "intro"], "filenames": ["00-basic-concepts/01-fourier-transform.ipynb", "01-grokking-modular-addition/01-grokking-modular-addition.ipynb", "02-thoughts-essays/2023-02-24-klara-and-the-sun.md", "03-sae/sae.ipynb", "04-cognitive-biases/cognitive-biases.ipynb", "05-superposition/smaller-models-of-superposition.ipynb", "README.md", "intro.md"], "titles": ["Frequency-Domain Analysis and Fourier Transforms", "Grokking Modular Addition", "Klara and the Sun", "Sparse Autoencoders &amp; Superposition", "Cognitive biases in LLMs", "Even Smaller Models of Superposition", "&lt;no title&gt;", "Mechanistic Interpretability Notebooks"], "terms": {"thi": [0, 1, 3, 4, 5, 6, 7], "notebook": [0, 1, 3, 5, 6], "contain": [0, 1, 6, 7], "few": [0, 1, 2, 3, 4, 5, 6, 7], "basic": [0, 3, 6, 7], "exercis": [0, 1, 4], "illustr": 0, "how": [0, 2, 5, 6, 7], "relat": 0, "can": [0, 1, 2, 4, 5], "help": [0, 1, 3, 4, 6, 7], "u": [0, 1, 2, 3, 4, 5], "analyz": [0, 1, 4], "pattern": 0, "almost": [0, 1], "all": [0, 2, 3, 4], "helper": [0, 1, 3], "function": [0, 1, 3, 4, 5], "have": [0, 1, 2, 4, 5], "been": [0, 1], "taken": [0, 1], "from": [0, 2, 4, 5], "neel": [0, 1], "nanda": [0, 1], "": [0, 1, 2, 3, 4, 5, 6, 7], "contribut": [0, 1], "arena": [0, 1], "materi": [0, 1, 2], "hi": [0, 1, 2], "studi": [0, 1, 3], "grokk": [0, 7], "modular": [0, 7], "arithmet": [0, 1], "If": [0, 1, 4, 5, 6, 7], "necessari": [0, 1], "instal": [0, 1, 3], "requir": [0, 1, 4], "repositori": [0, 1, 6], "root": [0, 1], "pip": [0, 1, 3], "r": [0, 1, 4, 5], "txt": [0, 1], "import": [0, 1, 3, 4, 5], "torch": [0, 1, 3, 5], "t": [0, 1, 2, 3, 4, 5], "tensor": [0, 1, 3, 5], "nn": [0, 1, 3, 5], "f": [0, 1, 3, 4, 5], "numpi": [0, 1, 3, 5], "np": [0, 1, 3, 5], "pathlib": [0, 1], "path": [0, 1, 3], "o": [0, 1, 3], "sy": [0, 1], "plotli": [0, 1, 3, 5], "express": [0, 1, 3, 5], "px": [0, 1, 3, 5], "graph_object": [0, 1, 5], "go": [0, 1, 3, 4, 5], "functool": [0, 1, 3], "type": [0, 1, 3, 5], "list": [0, 1, 3], "tupl": [0, 1], "union": [0, 1], "option": [0, 1, 3], "callabl": [0, 1], "fancy_einsum": [0, 1], "einsum": [0, 1, 3, 5], "einop": [0, 1, 3, 5], "jaxtyp": [0, 1], "float": [0, 1, 3, 5], "int": [0, 1, 3, 5], "tqdm": [0, 1, 3, 5], "transformer_len": [0, 1, 3], "util": [0, 1, 3], "panda": [0, 3], "pd": [0, 3], "def": [0, 1, 3, 4, 5], "line": [0, 1, 3, 5], "x": [0, 1, 4, 5], "y": [0, 1, 4, 5], "none": [0, 1, 3, 5], "hover": [0, 1], "xaxi": [0, 1, 5], "yaxi": [0, 1, 5], "kwarg": 0, "to_numpi": [0, 1], "flatten": [0, 1, 5], "fig": [0, 3, 5], "hover_nam": 0, "update_layout": [0, 5], "xaxis_titl": 0, "yaxis_titl": 0, "ndim": 0, "1": [0, 1, 3, 4, 5], "showlegend": [0, 5], "fals": [0, 1, 3, 5], "show": [0, 1, 3, 5], "scatter": [0, 1, 5], "titl": [0, 1, 5], "colorbar_titl": [0, 1], "label": [0, 1, 5], "color": [0, 1, 5], "xaxis_rang": 0, "update_xax": [0, 5], "rang": [0, 1, 3, 5], "yaxis_rang": 0, "update_yax": [0, 5], "lines_list": [0, 1], "mode": [0, 1, 5], "log_i": [0, 1, 3], "plot": [0, 1, 3], "multipl": [0, 1], "i": [0, 2, 3, 4, 5, 6, 7], "shape": [0, 1, 2, 3], "0": [0, 1, 3, 4, 5], "arang": [0, 1], "len": [0, 1, 3, 5], "figur": 0, "layout": [0, 5], "c": [0, 1], "enumer": [0, 1, 3, 4, 5], "els": [0, 1, 3, 5], "add_trac": [0, 5], "name": [0, 1, 2, 5], "hovertext": 0, "yaxis_typ": 0, "log": 0, "line_mark": 0, "marker": [0, 5], "animate_lin": [0, 1], "snapshot_index": [0, 1], "snapshot": [0, 1], "stack": [0, 1, 3], "axi": [0, 1], "j": [0, 1], "row": [0, 1, 3, 5], "append": [0, 1, 3, 5], "df": 0, "datafram": [0, 3], "column": [0, 1, 5], "animation_fram": [0, 1], "range_i": 0, "min": [0, 5], "max": [0, 3, 5], "imshow": [0, 1, 3], "animation_nam": [0, 1], "vline_posit": 0, "vline_label": 0, "hline_posit": 0, "hline_label": 0, "animation_label": 0, "squeez": [0, 3, 5], "slider": [0, 5], "step": [0, 1, 3, 5], "text": [0, 3, 5], "zip": [0, 3], "add_vlin": 0, "5": [0, 1, 4, 5], "line_width": 0, "annotation_text": 0, "annotation_posit": 0, "top": [0, 1, 3], "left": [0, 1, 5], "add_hlin": 0, "y_axi": 0, "x_axi": 0, "get": [0, 1, 3, 4, 5], "autorang": 0, "set": [0, 1, 4, 6, 7], "default": [0, 1], "colour": 0, "scheme": 0, "partial": [0, 1, 3], "color_continuous_scal": [0, 1], "blue": [0, 1, 5], "creat": [0, 1, 3, 4, 6, 7], "good": [0, 1, 2, 4, 6, 7], "diverg": 0, "scale": 0, "ie": 0, "both": [0, 1, 2, 4, 5], "posit": [0, 1], "neg": [0, 1, 4], "valu": [0, 1, 2, 3, 5], "where": [0, 1, 5, 6, 7], "white": [0, 2], "imshow_div": [0, 1], "rdbu": 0, "color_continuous_midpoint": 0, "imshow_fouri": [0, 1], "facet_label": [0, 1], "xlim": [0, 1], "ylim": [0, 1], "nice": 0, "assum": [0, 1, 5], "alreadi": [0, 1, 6, 7], "fourier_basis_nam": [0, 1], "horizont": [0, 1], "compon": [0, 1, 3, 5], "vertic": [0, 1], "updat": [0, 1, 3], "data": [0, 1, 3, 4, 5], "hovertempl": 0, "br": [0, 5], "z": [0, 1], "4f": [0, 5], "annot": [0, 5], "animate_multi_lin": [0, 1], "y_index": [0, 1], "swap_y_anim": 0, "an": [0, 1, 2, 3, 4, 5], "anim": [0, 1, 2, 4, 5], "transpos": [0, 1], "str": [0, 1, 5], "print": [0, 1, 3, 4, 5], "animate_scatt": [0, 1], "color_nam": [0, 1], "ha": [0, 4, 5, 6, 7], "ones": [0, 1, 2, 3, 5], "repeat": 0, "item": [0, 1, 3, 5], "range_x": 0, "backend": [0, 1, 5], "mp": [0, 1, 3, 5], "is_avail": [0, 1, 5], "devic": [0, 1, 3, 5], "elif": [0, 1, 5], "cuda": [0, 1, 5], "cpu": [0, 1, 3, 5], "The": [0, 2, 5, 6], "tell": [0, 1], "what": [0, 2, 4, 5, 6, 7], "make": [0, 1, 2, 4, 6, 7], "up": [0, 2, 6, 7], "given": [0, 1, 5], "sequenc": [0, 1, 3], "we": [0, 2, 3, 5], "think": [0, 1, 2, 4, 6, 7], "chang": [0, 1, 4], "take": [0, 1], "length": [0, 1], "appli": [0, 3], "linear": [0, 1], "repres": [0, 1], "new": [0, 1, 2, 4, 6, 7], "number": [0, 1, 5], "which": [0, 1, 2, 4, 5, 6, 7], "call": [0, 1, 3, 4, 5], "coeffici": [0, 1], "amplitud": [0, 1], "seri": [0, 1], "period": 0, "integ": [0, 1], "frac": [0, 1], "pi": [0, 1], "fulli": [0, 1, 2], "reconstruct": [0, 1, 3], "origin": [0, 1, 3], "mathemat": 0, "speak": 0, "same": [0, 1, 2, 3, 5], "each": [0, 1, 5], "element": [0, 1, 2], "x_k": 0, "result": [0, 1, 4], "project": [0, 1, 4, 5], "onto": [0, 1, 5], "k": [0, 1], "th": [0, 1], "vector": [0, 1, 3, 5], "b": [0, 1, 3, 4, 5], "complex": [0, 1], "sinusoid": 0, "omega_k": [0, 1], "e": [0, 1, 3, 5], "j2": 0, "co": [0, 1], "sin": [0, 1], "sum_": [0, 5], "x_n": 0, "cdot": [0, 1], "b_n": 0, "us": [0, 2, 3, 4, 5], "lead": [0, 1, 4], "exhibit": [0, 1], "veri": [0, 1, 2, 5], "interest": [0, 1], "properti": [0, 1], "turn": [0, 1], "input": [0, 3, 5], "shift": [0, 1, 5], "phase": [0, 1], "convolut": 0, "wise": [0, 1], "product": [0, 1, 4], "you": [0, 1, 3, 4, 5], "read": [0, 1, 2, 3, 4], "about": [0, 1, 2], "them": [0, 1, 2, 3, 4, 5], "here": [0, 1, 4, 6], "For": [0, 1], "purpos": [0, 2, 3, 6, 7], "howev": [0, 1, 2, 4], "re": [0, 1, 3], "mainli": [0, 1], "broader": [0, 2], "notion": [0, 1, 6, 7], "In": [0, 1], "other": [0, 1, 2, 3, 4], "word": [0, 4], "our": [0, 1, 2], "kei": [0, 4], "takeawai": [0, 1], "measur": [0, 1, 3], "strongli": 0, "captur": [0, 1], "more": [0, 1, 2, 4], "gener": [0, 1, 2, 4], "below": [0, 1, 5], "ar": [0, 1, 2, 3, 4, 5, 6], "necessarili": [0, 1, 4], "rather": [0, 1], "some": [0, 1, 2, 3, 4, 6, 7], "sum": [0, 3], "matrix": [0, 1], "rewrit": [0, 5], "whose": [0, 1, 2], "begin": [0, 1], "bmatrix": [0, 1], "x_0": 0, "end": [0, 1], "0_0": 0, "0_n": 0, "1_0": 0, "1_n": 0, "vdot": 0, "ddot": 0, "n_0": 0, "n_n": 0, "dot": [0, 1, 5], "between": [0, 3, 5], "rest": [0, 1], "ll": [0, 1, 5], "refer": [0, 1, 5], "even": [0, 1, 2, 7], "when": [0, 1, 2, 3], "thei": [0, 1, 2, 3, 4, 5], "actual": [0, 1, 2, 6, 7], "formul": 0, "increas": [0, 1, 4], "also": [0, 1, 2, 6, 7], "space": [0, 2, 5], "occupi": 0, "abus": 0, "terminologi": 0, "simplifi": 0, "explan": [0, 1, 4], "still": [0, 1, 3, 4], "suggest": [0, 1, 2], "correct": [0, 1], "intuit": [0, 1], "understand": [0, 1, 2, 6, 7], "next": [0, 1, 3], "section": [0, 1], "see": [0, 1, 2, 3, 5], "perform": [0, 1, 3], "desir": [0, 1], "task": 0, "save": [0, 3, 4], "inconveni": 0, "deal": [0, 1], "follow": [0, 1, 2, 4], "time": [0, 1, 2, 6, 7], "leftarrow": 0, "rightarrow": [0, 5], "6pt": 0, "first": [0, 1, 2, 3, 4, 5, 6, 7], "constant": [0, 1, 5], "altern": 0, "omega": [0, 1], "code": [0, 1], "As": [0, 1, 2], "explain": [0, 1, 6, 7], "abov": [0, 1], "thought": [0, 1, 2], "plu": [0, 1], "respect": [0, 1], "12": [0, 1, 3, 5], "6": [0, 1, 4, 5], "13": [0, 3], "everi": [0, 1], "divid": [0, 1], "its": [0, 1, 2, 3, 6, 7], "own": [0, 1, 3, 6, 7], "norm": [0, 1, 3, 5], "order": [0, 1, 2], "preserv": [0, 4, 5], "interact": 0, "allow": [0, 1], "view": [0, 1, 2], "plai": [0, 1, 5], "button": [0, 5], "transit": [0, 1], "weird": [0, 1], "wai": [0, 1, 2, 4, 6, 7], "so": [0, 1, 2, 3, 6, 7], "might": [0, 1, 2, 3, 4, 5], "easiest": 0, "simpli": [0, 1, 2, 3], "drag": 0, "128": [0, 1, 3], "make_fourier_basi": [0, 1], "return": [0, 1, 3, 4, 5], "pair": [0, 3, 5], "fourier_basi": [0, 1], "g": [0, 1, 5], "const": [0, 1], "exclud": [0, 1], "last": [0, 1, 2], "one": [0, 1, 2, 3, 4, 5, 6, 7], "p": [0, 1], "normal": [0, 1, 3], "dim": [0, 1, 3], "keepdim": 0, "true": [0, 1, 3, 4, 5], "introduc": [0, 1], "annoi": [0, 3], "littl": 0, "problem": [0, 1], "work": [0, 2, 3, 4, 6, 7], "around": [0, 2], "under": 0, "particular": 0, "definit": [0, 2], "theori": [0, 1], "mean": [0, 1, 2, 3, 5], "exactli": [0, 5], "odd": [0, 1], "129": 0, "64": [0, 1, 3], "total": [0, 1], "practic": [0, 6, 7], "inspect": [0, 1], "discard": [0, 1], "final": [0, 1, 5, 6, 7], "why": [0, 1, 2, 5], "seemingli": [0, 1], "perfectli": 0, "valid": [0, 1], "much": [0, 1, 2, 3, 5, 6, 7], "like": [0, 1, 2, 4], "correspond": [0, 1], "complet": [0, 4], "whole": [0, 1, 6, 7], "oscil": 0, "two": [0, 1, 2, 4, 5], "would": [0, 1, 3, 4, 6, 7], "were": [0, 1, 2, 6, 7], "continu": [0, 1, 4], "real": [0, 1], "includ": [0, 1, 3], "12345": 0, "fine": 0, "discret": [0, 1], "variabl": [0, 1], "effect": [0, 1, 4], "sampl": [0, 3, 5], "alwai": [0, 1, 3, 4], "zero": [0, 1, 3], "arbitrarili": 0, "decid": [0, 1, 3], "don": [0, 3, 4], "care": [0, 1, 4], "nor": 0, "case": [0, 1, 4, 5], "evalu": 0, "It": [0, 1, 4, 6, 7], "unfortun": [0, 1], "happen": [0, 2, 5], "cross": [0, 1, 3], "handi": 0, "sinc": [0, 1, 2, 3], "zoom": [0, 1], "10": [0, 1, 3, 4, 5], "cycl": [0, 1], "expect": [0, 1, 4], "ident": [0, 1], "except": [0, 1, 3], "offset": 0, "becaus": [0, 1, 2, 3, 5, 6, 7], "maximum": [0, 1], "minimum": 0, "wherea": [0, 1], "x_densiti": 0, "100": [0, 1, 3, 4, 5], "linspac": 0, "cosx": 0, "sinx": 0, "n_lim": 0, "x_lim": 0, "cosn": 0, "sinn": 0, "recal": [0, 1], "decept": 0, "simpl": [0, 1, 3], "implement": [0, 2, 3, 4], "just": [0, 1, 2, 3, 6, 7], "again": [0, 1, 3], "fft": [0, 1], "loos": 0, "fft1d": [0, 1], "batch": [0, 1, 3], "_": [0, 1, 3], "let": [0, 1, 3, 5], "test": [0, 2, 3, 4], "squar": [0, 1, 3, 5], "magnitud": 0, "look": [0, 4], "a1": 0, "3": [0, 1, 3, 4, 5], "w1": 0, "20": [0, 1, 3, 4], "a2": 0, "w2": 0, "pow": [0, 1, 3], "visibli": 0, "somewhat": [0, 6, 7], "messi": 0, "highli": [0, 1], "spars": [0, 1], "clean": [0, 4], "inde": [0, 1], "over": [0, 1, 2, 3], "peak": [0, 1], "out": [0, 2, 3, 5], "differ": [0, 1, 2, 3, 4], "kind": [0, 1, 2], "thing": [0, 1, 2], "world": [0, 1, 2, 3], "distinct": [0, 4], "far": [0, 1, 2], "best": [0, 2, 4, 6, 7], "develop": [0, 2, 4, 6, 7], "start": [0, 1, 3], "load": [0, 3], "record": 0, "flute": 0, "wa": [0, 1, 2], "post": [0, 1], "freesound": 0, "user": [0, 1, 4], "juskiddink": 0, "descript": [0, 2, 6, 7], "clai": 0, "bird": 0, "size": [0, 1, 5], "place": [0, 1], "mouth": 0, "blown": 0, "togeth": 0, "give": [0, 1, 5], "find": [0, 5], "ambigu": 0, "simultan": 0, "do": [0, 2, 6, 7], "fact": [0, 1], "being": [0, 2, 5], "pitch": 0, "identifi": [0, 1], "those": [0, 1, 2], "torchaudio": 0, "ipython": 0, "displai": [0, 2], "ipd": 0, "environ": [0, 3], "torchaudio_use_backend_dispatch": 0, "wav": 0, "sr": 0, "audio": 0, "detach": [0, 1, 3, 5], "rate": [0, 4], "your": [0, 3, 4], "browser": 0, "doe": 0, "support": [0, 1], "implicitli": 0, "stationari": 0, "intens": 0, "throughout": [0, 1, 3], "reason": [0, 1, 6, 7], "limit": [0, 1, 2, 5], "operand": 0, "file": 0, "second": [0, 1, 5, 6, 7], "44": [0, 1, 3], "point": [0, 1, 2, 5], "small": [0, 1, 3], "50": [0, 1, 3, 4, 5], "milisecond": 0, "slice": [0, 1], "sound": 0, "By": [0, 1], "trial": 0, "error": [0, 1, 5], "fragment": [0, 2], "150m": 0, "200m": 0, "timestamp": 0, "seem": [0, 1, 2], "fairli": [0, 1], "keep": [0, 3], "channel": [0, 5], "onli": [0, 2, 4, 5, 6, 7], "x_min": 0, "15": [0, 1, 3, 5], "x_max": 0, "wav_sampl": 0, "waveform": 0, "wav_n": 0, "wav_basi": 0, "wav_basis_nam": 0, "wav_spectrum": 0, "max_k": 0, "300": [0, 4], "That": [0, 1, 4], "pretti": [0, 1, 6, 7], "promis": 0, "without": [0, 1, 3, 4], "too": [0, 3], "detail": [0, 1], "indic": [0, 1, 2, 3, 5], "formula": [0, 1], "f_": 0, "signal": [0, 1], "index": [0, 1], "consid": [0, 1], "occur": [0, 1, 4], "25": 0, "32": 0, "frequency_to_not": 0, "isn": [0, 1, 4], "essenti": [0, 1], "base": [0, 1], "map": [0, 1, 3], "along": [0, 1], "logarithm": 0, "math": [0, 4], "a4": 0, "440": 0, "hz": 0, "a4_frequ": 0, "semiton": 0, "awai": 0, "log2": 0, "note_nam": 0, "d": [0, 1, 5], "octav": 0, "4": [0, 1, 4, 5], "note_index": 0, "f1": 0, "note1": 0, "f2": 0, "note2": 0, "500": [0, 1, 3, 4, 5], "d4": 0, "640": 0, "instrument": 0, "nearbi": 0, "try": [0, 1, 3, 4, 6, 7], "bright": 0, "major": [0, 1, 4], "third": [0, 1, 4], "quit": [0, 1, 4], "close": [0, 1], "halfwai": 0, "build": [0, 1], "tuner": 0, "now": [0, 1, 2], "decent": [0, 1], "But": [0, 1], "imag": 0, "right": [0, 1], "understood": [0, 1], "analogi": 0, "instead": [0, 1, 5], "x_": 0, "m": [0, 1, 6, 7], "simplic": [0, 1], "dimens": [0, 1, 3, 5], "therefor": [0, 1], "l": [0, 1], "want": [0, 1, 3, 5], "had": [0, 1, 2, 3], "similarli": [0, 1], "straightforward": 0, "outer": 0, "comput": [0, 1], "singl": [0, 1, 5], "magic": [0, 1], "nevertheless": 0, "come": [0, 2], "fourier_2d_basis_term": [0, 1], "direct": [0, 1, 5], "fft2d": [0, 1], "retun": 0, "asum": 0, "present": [0, 2], "output": [0, 1, 3, 5], "multipli": [0, 1], "pn": 0, "pm": 0, "7": [0, 1, 4, 5], "combin": [0, 1, 5], "hand": [0, 1], "example_fn": 0, "14": [0, 1], "46": [0, 3], "8": [0, 4, 5], "30": [0, 1, 4], "dens": [0, 1], "becom": [0, 1, 2], "incredibli": [0, 2], "easili": [0, 1], "spot": 0, "non": [0, 1, 4], "wrap": [0, 3, 4], "hopefulli": 0, "solidifi": [0, 6, 7], "exhiibit": 0, "learn": [0, 2, 4, 5, 6, 7], "recommend": 0, "check": [0, 1], "incred": [0, 3], "video": 0, "legendari": 0, "3blue1brown": 0, "dani": 1, "balcel": 1, "april": 1, "2nd": 1, "2024": 1, "A": [1, 3, 4], "week": 1, "ago": 1, "bunch": 1, "recurs": 1, "center": 1, "finish": [1, 2, 3], "through": [1, 3, 4, 5], "most": [1, 2, 6, 7], "cours": 1, "changlin": 1, "li": 1, "kindli": 1, "walk": 1, "r\u00e9gi": 1, "schiavi": 1, "track": [1, 3], "replic": [1, 6, 7], "2023": [1, 2], "paper": 1, "et": 1, "al": 1, "progress": 1, "via": 1, "mechanist": [1, 6], "interpret": [1, 3, 6], "sever": 1, "bit": [1, 2], "felt": 1, "difficulti": 1, "compar": [1, 3, 4, 5], "worth": [1, 3, 4], "write": [1, 2], "blog": 1, "borrow": 1, "heavili": 1, "content": [1, 4], "specif": 1, "gdown": 1, "activationcach": [1, 3], "hookedtransform": [1, 3], "hookedtransformerconfig": [1, 3], "hook_point": [1, 3], "hookpoint": [1, 3], "layernorm": 1, "my_util": 1, "main": [1, 2, 3], "conduct": 1, "concept": 1, "neural": [1, 2], "network": 1, "offer": [1, 4], "conveni": [1, 5], "back": [1, 2, 3, 5], "overfit": 1, "central": 1, "virtual": 1, "form": [1, 2, 5], "supervis": 1, "machin": [1, 2, 6, 7], "exampl": [1, 3, 5], "pictur": 1, "cat": [1, 2, 3, 4], "dog": [1, 4], "parrot": 1, "correctli": 1, "critic": 1, "though": 1, "abl": 1, "process": 1, "memor": 1, "rule": 1, "well": [1, 3, 6, 7], "common": 1, "avoid": [1, 4], "hold": 1, "part": 1, "paramet": [1, 3, 5], "unseen": 1, "abil": 1, "mani": [1, 2, 3], "scenario": [1, 4], "often": [1, 2, 4], "roughli": 1, "slightli": [1, 3], "wors": 1, "than": [1, 2, 4], "recent": [1, 2], "experi": [1, 2, 4], "shown": 1, "unusu": [1, 4], "relationship": 1, "initi": [1, 4, 5], "drop": 1, "quickli": 1, "while": [1, 4], "remain": [1, 4], "high": 1, "confront": 1, "behavior": [1, 2], "perhap": [1, 2], "after": [1, 3], "design": 1, "amount": 1, "consider": 1, "epoch": [1, 3, 5], "000": 1, "low": [1, 4], "suddenli": 1, "long": 1, "sudden": 1, "past": [1, 6, 7], "puzzl": 1, "prompt": [1, 3, 4], "intrigu": 1, "question": [1, 2, 4], "push": 1, "until": 1, "reach": 1, "solut": 1, "level": [1, 4], "individu": [1, 4], "circuit": 1, "implic": 1, "safeti": [1, 4], "exemplifi": 1, "emerg": 1, "deep": [1, 2], "qualit": [1, 5], "leap": 1, "capabl": [1, 2], "appear": 1, "rel": 1, "short": 1, "sort": [1, 3], "principl": 1, "describ": [1, 2], "quantit": 1, "outcom": [1, 4], "perspect": 1, "hard": 1, "predict": 1, "futur": [1, 2], "extrapol": 1, "current": [1, 5, 6, 7], "self": [1, 2, 3, 5], "percept": [1, 2], "deceiv": 1, "aris": 1, "shed": 1, "light": 1, "focus": 1, "residu": 1, "70": [1, 4], "113": 1, "120": 1, "constrain": 1, "version": 1, "fix": 1, "revers": [1, 3, 5], "engin": 1, "transform": [1, 5, 7], "layer": [1, 3], "four": [1, 4], "attent": [1, 4], "head": 1, "d_model": [1, 3], "d_mlp": [1, 3], "512": [1, 3], "diagram": 1, "three": [1, 4], "hot": [1, 3], "encod": [1, 3], "token": [1, 3], "probabl": [1, 4, 5], "distribut": [1, 5], "oper": 1, "feed": 1, "forward": [1, 3, 5], "entropi": [1, 3], "note": [1, 5], "treat": 1, "classif": 1, "arbitrari": 1, "beyond": 1, "scope": 1, "primarili": 1, "concern": 1, "done": 1, "full": 1, "toi": 1, "entir": 1, "769": 1, "possibl": [1, 2, 5], "adamw": [1, 5], "decai": 1, "wd": 1, "role": [1, 4], "later": 1, "defin": [1, 4], "cfg": [1, 3], "n_layer": [1, 3], "d_vocab": [1, 3], "n_head": [1, 3], "d_head": [1, 3], "n_ctx": [1, 3], "act_fn": [1, 3], "relu": [1, 3], "normalization_typ": 1, "large_root": 1, "large_fil": 1, "exist": [1, 2, 6, 7], "mkdir": 1, "huggingface_hub": 1, "hf_hub_download": 1, "repo_id": 1, "callummcdougal": 1, "grokking_full_run_data": 1, "filenam": 1, "full_run_data": 1, "pth": 1, "local_dir": 1, "full_run_data_path": 1, "map_loc": 1, "state_dict": 1, "400": [1, 4], "load_in_state_dict": 1, "dataset": [1, 5], "characterist": 1, "1e": [1, 5], "unchang": 1, "shortli": 1, "befor": 1, "mark": 1, "sharpli": 1, "could": 1, "caus": [1, 2], "train_loss": [1, 5], "test_loss": 1, "5000": 1, "run": [1, 3], "intern": [1, 2], "cach": [1, 3], "all_data": 1, "fn": 1, "original_logit": 1, "run_with_cach": [1, 3], "remov": 1, "original_loss": 1, "cross_entropy_high_precis": 1, "2": [1, 4, 5], "0160624103482405e": 1, "07": 1, "librari": 1, "access": [1, 6, 7], "intermedi": 1, "ani": [1, 2, 5], "score": [1, 4], "earlier": 1, "paid": 1, "itself": [1, 2], "averag": 1, "across": [1, 5], "pai": 1, "equal": [1, 4], "sens": [1, 2], "inform": [1, 5], "job": [1, 2], "precis": 1, "move": 1, "attn_p": 1, "block": [1, 3], "attn": 1, "hook_pattern": 1, "mean_final_pos_attn": 1, "12769": 1, "conceptu": 1, "found": [1, 2, 3], "grok": 1, "myself": [1, 6, 7], "rememb": 1, "ve": [1, 2], "fed": 1, "112": 1, "took": 1, "rearrang": [1, 3], "separ": [1, 3], "certain": [1, 2], "a_i": 1, "113x113": 1, "a_": 1, "xy": 1, "bother": 1, "mlp": [1, 3], "neuron_acts_post": 1, "hook_post": [1, 3], "neuron_acts_pr": 1, "hook_pr": 1, "neuron_acts_post_sq": 1, "neuron_acts_pre_sq": 1, "top_k": [1, 3], "inputs_heatmap": 1, "saw": [1, 3], "verifi": [1, 3], "similar": [1, 2], "attn_mat": 1, "attn_mat_sq": 1, "seq": [1, 3], "within": 1, "ov": 1, "w_e": [1, 3], "w_v": 1, "w_o": 1, "w_": 1, "matric": 1, "neur": 1, "count": 1, "asid": 1, "w_in": 1, "calcul": [1, 3], "w_neur": 1, "qk": 1, "r_": 1, "_po": 1, "w_q": 1, "w_k": 1, "po": 1, "stream": [1, 3], "v": 1, "w": [1, 5], "queri": 1, "establish": 1, "w_po": 1, "side": [1, 3, 5], "final_pos_resid_initi": 1, "w_attn": 1, "w_qk": 1, "mt": 1, "sqrt": [1, 3], "pre": [1, 3], "softmax": [1, 3], "0th": [1, 3], "1st": 1, "counterintuit": 1, "me": [1, 2, 3, 5, 6, 7], "paus": [1, 5], "extra": 1, "sai": [1, 4], "opposit": 1, "embedding_dim": 1, "thankfulli": 1, "tool": 1, "belt": 1, "easi": 1, "n": 1, "sine": 1, "cosin": 1, "lossless": 1, "depth": 1, "feel": 1, "free": 1, "domain": [1, 7], "highlight": 1, "observ": 1, "attn_mat_fourier_basi": 1, "neuron_acts_post_fourier_basi": 1, "sign": 1, "previous": 1, "seen": [1, 2], "1d": 1, "respond": 1, "fft1d_given_dim": 1, "w_neur_fouri": 1, "11": [1, 3], "aspect": [1, 2], "tune": 1, "bia": [1, 4, 5], "2d": 1, "neuron_acts_cent": 1, "neuron_acts_centered_fouri": 1, "structur": 1, "ax": [1, 5], "diagon": 1, "These": [1, 2], "arrang": 1, "react": 1, "per": [1, 5], "arrange_by_2d_freq": 1, "idx_2d_y_al": 1, "idx_2d_x_al": 1, "freq": 1, "idx_1d": 1, "sensit": 1, "salient": 1, "energi": [1, 4], "9": [1, 3, 4], "highest": 1, "argmax": [1, 3], "ing": 1, "previou": [1, 4], "salienc": 1, "ratio": [1, 3], "find_neuron_freq": 1, "fourier_neuron_act": 1, "neuron_freq": 1, "neuron_frac_explain": 1, "varianc": 1, "fraction": 1, "fourier_neuron_acts_by_freq": 1, "assert": 1, "sum_per_freq": 1, "sum_across_freq": 1, "key_freq": 1, "neuron_freq_count": 1, "uniqu": [1, 4], "return_count": 1, "fraction_of_activations_positive_at_posn2": 1, "35": [1, 3], "41": 1, "42": [1, 3], "52": [1, 3], "lot": [1, 2], "unpack": 1, "biggest": 1, "influenc": 1, "nine": [1, 4], "clearli": 1, "visibl": 1, "cluster": 1, "There": 1, "five": 1, "chart": 1, "93": 1, "associ": [1, 2], "yellow": 1, "fire": 1, "although": 1, "group": 1, "concentr": 1, "85": 1, "key_freqs_plu": 1, "concaten": [1, 5], "new_on": 1, "fourier_norms_in_each_clust": 1, "reduc": [1, 4], "batch_i": 1, "batch_x": 1, "facet_col": 1, "145": 1, "87": 1, "79": 1, "huge": 1, "least": [1, 6, 7], "attribut": 1, "aren": [1, 2], "grai": [1, 5], "area": 1, "byproduct": [1, 2], "enough": 1, "perfect": 1, "hypothesi": 1, "causal": 1, "eight": 1, "cannot": 1, "lost": [1, 4], "w_u": [1, 3], "unembed": 1, "add": [1, 4], "consist": [1, 4, 6, 7], "unfilt": 1, "project_onto_direct": 1, "batch_vec": 1, "norm_v": 1, "project_onto_frequ": 1, "zeros_lik": [1, 3, 5], "basis_ind": 1, "logits_in_freq": 1, "w_out": [1, 3], "w_logit": 1, "filtered_neuron_act": 1, "filtered_neuron_acts_in_freq": 1, "calcluat": 1, "filter": 1, "logits_always_fir": 1, "6e": 1, "format": 1, "test_logit": 1, "bias_correct": 1, "016062e": 1, "869221e": 1, "121782e": 1, "06": 1, "fascin": [1, 2], "improv": [1, 3, 4], "know": 1, "explicit": 1, "propos": 1, "approxim": 1, "albeit": 1, "should": [1, 5], "forc": [1, 6, 7], "believ": [1, 2], "doesn": 1, "immedi": [1, 5], "prove": 1, "fail": [1, 4], "disprov": 1, "degrad": 1, "wrong": 1, "someth": [1, 2], "catastroph": 1, "sizabl": 1, "9f": 1, "000000202": 1, "000199599": 1, "000458831": 1, "001917969": 1, "005197648": 1, "024398938": 1, "000001122": 1, "trivial": 1, "rough": 1, "gamma": 1, "signific": [1, 4], "approx": 1, "alpha": 1, "beta": 1, "person": [1, 2, 4], "didn": 1, "argument": 1, "themselv": 1, "recogn": 1, "handwavei": 1, "hope": [1, 2], "dive": 1, "sake": 1, "happi": 1, "faith": [1, 2], "resembl": 1, "thank": 1, "To": [1, 2, 5], "revisit": [1, 6, 7], "school": [1, 4], "class": [1, 2, 3, 5], "mai": [1, 4], "equat": 1, "interestingli": [1, 2], "match": [1, 3], "82": 1, "manual": 1, "restrict": 1, "involv": 1, "get_trig_sum_direct": 1, "\u03c9_k": 1, "cosx_cosy_direct": 1, "sinx_siny_direct": 1, "sinx_cosy_direct": 1, "cosx_siny_direct": 1, "cos_xplusy_direct": 1, "sin_xplusy_direct": 1, "trig_logit": 1, "cos_xplusy_project": 1, "sin_xplusy_project": 1, "extend": [1, 4, 5], "4e": 1, "0161e": 1, "0549e": 1, "09": [1, 3], "factor": [1, 5], "won": 1, "surpris": 1, "neuron_ind": 1, "need": [1, 2, 4, 5], "replac": 1, "equival": [1, 5], "omit": 1, "hidden": [1, 5], "assign": 1, "sum_k": 1, "c_k": 1, "modulo": 1, "maxim": 1, "dictat": 1, "spread": 1, "interfer": 1, "destruct": 1, "narrow": 1, "whew": 1, "got": 1, "hairi": 1, "recap": 1, "featur": [1, 3, 5], "further": 1, "presenc": 1, "evolv": 1, "less": [1, 2, 4], "ask": 1, "written": 1, "metric": [1, 2, 3, 5], "staff": 1, "snippet": 1, "longer": 1, "cell": 1, "fold": 1, "easier": [1, 4, 6, 7], "toggl": 1, "open": [1, 4, 6, 7], "pass": 1, "store": 1, "metric_cach": 1, "get_metr": 1, "metric_fn": 1, "reset": 1, "recomput": 1, "sd": 1, "arrai": 1, "plot_metr": 1, "variant": 1, "subtract": 1, "excl_loss": 1, "excl_loss_list": 1, "cos_xplusy_compon": 1, "sin_xplusy_compon": 1, "excl_logit": 1, "concat": [1, 3], "excl": 1, "thousand": 1, "noth": 1, "paint": 1, "flat": 1, "reli": 1, "known": 1, "incorrectli": 1, "anyth": 1, "random": [1, 3], "chanc": [1, 4], "gradient": [1, 5], "deriv": [1, 2], "idea": 1, "smooth": 1, "frame": [1, 4, 5], "200": [1, 3, 4], "depict": 1, "fourier_emb": 1, "basis_nam": 1, "embed_fouri": 1, "animation_group": 1, "var": 1, "folder": 1, "qr": 1, "g0lrlj7s3sl9xyxgtbt3zrd00000gn": 1, "ipykernel_49113": 1, "1154314699": 1, "py": 1, "userwarn": 1, "ndarrai": 1, "extrem": 1, "slow": 1, "pleas": [1, 4], "convert": 1, "trigger": 1, "runner": 1, "pytorch": 1, "csrc": 1, "tensor_new": 1, "cpp": 1, "278": 1, "mere": [1, 2], "18": [1, 3], "000th": 1, "stabil": 1, "evid": 1, "against": 1, "sheer": 1, "luck": 1, "made": [1, 2], "clear": [1, 4], "strong": 1, "depend": [1, 4], "answer": [1, 3, 4], "tensor_trig_ratio": 1, "\u03c9": 1, "neuron_pr": 1, "neuron_post": 1, "rais": 1, "valueerror": 1, "tensor_cent": 1, "tensor_var": 1, "tensor_trig_var": 1, "cos_xplusy_projection_var": 1, "sin_xplusy_projection_var": 1, "_trig_ratio": 1, "line_label": 1, "_trig_frac": 1, "sooner": 1, "conjectur": 1, "pure": [1, 2], "mediocr": 1, "pull": 1, "relev": 1, "imposs": 1, "adjust": [1, 2], "extract": 1, "get_frac_explain": 1, "return_typ": 1, "neuron_typ": 1, "neuron_act": 1, "clone": [1, 5], "neuron_acts_fouri": 1, "square_of_all_term": 1, "frac_explain": 1, "frac_explained_quadratic_term": 1, "3x3": 1, "grid": 1, "acts_fouri": 1, "squares_for_this_freq": 1, "squares_for_this_freq_quadratic_term": 1, "frac_act": 1, "nan_to_num": 1, "frac_explained_pr": 1, "frac_explained_quadratic_pr": 1, "frac_explained_post": 1, "frac_explained_quadratic_post": 1, "neuron_freqs_": 1, "viridi": [1, 5], "20k": 1, "quad": 1, "reflect": [1, 2], "smoothli": 1, "gradual": 1, "earli": 1, "consequ": 1, "nearli": 1, "grow": 1, "bigger": [1, 2], "One": [1, 3], "never": 1, "avg_attn_pattern": 1, "x100": 1, "avg": 1, "snap": 1, "zmax": 1, "zmin": 1, "text_auto": 1, "3f": 1, "said": 1, "truli": 1, "trig_loss": 1, "cos_xplusy_dir": 1, "sin_xplusy_dir": 1, "cos_xplusy_proj": 1, "sin_xplusy_proj": 1, "trig_loss_train": 1, "lab": 1, "notic": 1, "lower": [1, 4], "decreas": [1, 4], "execut": 1, "higher": [1, 4], "henc": 1, "greater": 1, "230": 1, "ad": [1, 4], "penalti": 1, "parameter_nam": 1, "param": 1, "named_paramet": 1, "sum_sq_weight": 1, "breviti": 1, "split": [1, 3], "effici": [1, 4], "larger": 1, "onc": [1, 2], "soon": 1, "exert": 1, "pressur": 1, "unpredict": 1, "thorough": 1, "discuss": [1, 2], "drawn": 1, "upon": 1, "my": [1, 2, 3, 6, 7], "With": 1, "larg": 1, "wouldn": [1, 2, 3, 4], "balanc": 1, "incent": 1, "shortest": 1, "minim": [1, 5], "cancel": 1, "lack": 1, "capac": 1, "reinforc": [1, 2], "superfici": 1, "regular": 1, "toward": [1, 3], "lesson": 1, "discov": 1, "anticip": 1, "align": 1, "manag": 1, "univers": 1, "ideal": 1, "potenti": [1, 4], "danger": 1, "beforehand": 1, "impend": 1, "volcano": 1, "erupt": 1, "ground": 1, "swell": 1, "seismic": 1, "gase": 1, "surfac": 1, "analog": 1, "monitor": 1, "anoth": [1, 2], "valuabl": 1, "came": [1, 2], "approach": 1, "doubt": 1, "idiosyncrat": 1, "crack": 1, "longest": 1, "piec": 1, "grappl": 1, "familiar": [1, 6, 7], "extent": 1, "insight": 1, "bizarr": 1, "inscrut": 1, "black": [1, 5, 6, 7], "box": [1, 6, 7], "greatli": 1, "encourag": [1, 6, 7], "field": [1, 3, 6, 7], "pursu": 1, "journal": 2, "entri": 2, "wrote": [2, 3], "februari": 2, "24th": 2, "kazuo": 2, "ishiguro": 2, "impress": 2, "scienc": 2, "fiction": 2, "book": [2, 4, 6], "ever": 2, "favorit": 2, "dad": 2, "interstellar": 2, "technologi": [2, 4], "specul": 2, "confirm": [2, 4], "cool": 2, "fanci": 2, "gadget": 2, "mirror": 2, "human": 2, "beautifulli": 2, "nerdi": 2, "love": 2, "graviti": 2, "travel": 2, "explor": 2, "ai": [2, 5], "conscious": 2, "deepli": 2, "touch": 2, "nuanc": 2, "technolog": 2, "advanc": 2, "philosoph": 2, "debat": 2, "skillfulli": 2, "topic": 2, "societ": 2, "backdrop": 2, "fear": 2, "intellig": 2, "beings": 2, "treatment": 2, "autom": 2, "disrupt": 2, "collar": 2, "genet": 2, "edit": 2, "impact": [2, 4], "stratif": 2, "friendship": 2, "parent": [2, 3], "sentient": 2, "ture": 2, "proof": 2, "imit": 2, "unintent": 2, "neurolog": 2, "religi": 2, "faulti": 2, "logic": 2, "inher": 2, "natur": [2, 4], "tap": 2, "subtler": 2, "superior": 2, "awar": 2, "optim": [2, 3, 5], "extern": 2, "selfless": 2, "irrat": 2, "bare": 2, "pose": 2, "liter": 2, "stai": 2, "portray": 2, "emot": 2, "novel": 2, "textur": 2, "confus": 2, "object": 2, "she": 2, "awkwardli": 2, "tini": 2, "off": [2, 3], "draw": 2, "her": [2, 3], "fetch": 2, "yet": 2, "accur": 2, "metaphor": 2, "disjoint": 2, "memori": 2, "malfunct": 2, "action": [2, 5], "contradict": 2, "instruct": 2, "judg": 2, "serv": 2, "reminisc": 2, "net": 2, "year": 2, "especi": 2, "shockingli": 2, "languag": 2, "model": [2, 4, 6, 7], "And": 2, "signatur": 2, "narrat": 2, "unreli": 2, "reader": 2, "underst": 2, "subtl": 2, "leav": [2, 5], "deciph": 2, "realli": [2, 4], "realist": 2, "immers": 2, "latent": 2, "sacrific": 2, "algorithm": 2, "besid": 2, "substrat": 2, "mind": 2, "exclus": 2, "realm": 2, "humankind": 2, "privat": 2, "monopoli": 2, "qualiti": [2, 4], "worthi": [2, 3], "matter": 2, "hunt": 2, "eat": 2, "dream": 2, "bond": 2, "peopl": [2, 3, 4, 6, 7], "mayb": 2, "attach": 2, "peter": 3, "kang": 3, "monosemant": 3, "ambiti": 3, "scratch": 3, "realiz": 3, "chose": 3, "shelf": 3, "transformerlen": 3, "At": 3, "ourselv": 3, "ran": 3, "bug": 3, "iter": [3, 4], "load_dataset": 3, "trainer": 3, "trainingargu": 3, "datacollatorwithpad": 3, "wandb": 3, "jeankaddour": 3, "minipil": 3, "save_to_disk": 3, "1024": 3, "tokenizer_nam": 3, "eleutherai": 3, "gpt": [3, 4], "neox": 3, "20b": 3, "pretrained_gelu_model": 3, "from_pretrain": 3, "1l": 3, "training_arg": 3, "output_dir": 3, "per_device_train_batch_s": 3, "10000": 3, "per_device_eval_batch_s": 3, "report_to": 3, "train_dataset": 3, "eval_dataset": 3, "break": 3, "indexerror": 3, "reproduc": 3, "train_dataload": 3, "get_train_dataload": 3, "loke": 3, "pretrain": 3, "goal": [3, 6, 7], "loop": [3, 4], "gelu_model": 3, "sae_input_dim": 3, "sae_hidden_dim": 3, "sae_output_dim": 3, "modul": [3, 5], "__init__": [3, 5], "input_dim": [3, 5], "hidden_dim": [3, 5], "init_rang": 3, "04": 3, "super": [3, 5], "bias_d": 3, "empti": [3, 5], "bias_": 3, "w_d": 3, "init": [3, 5], "normal_": 3, "std": 3, "inputs_cent": 3, "act_input": 3, "decod": [3, 5], "strings_to_token": 3, "string": 3, "input_id": 3, "rnn": 3, "pad_sequ": 3, "batch_first": 3, "padding_valu": 3, "logit": 3, "lmao": 3, "omg": 3, "pad": 3, "ew": 3, "input_token": 3, "eval": [3, 5], "act": 3, "batch_siz": 3, "acts_flat": 3, "sae_output": 3, "dataload": 3, "dataset_nam": 3, "train_text": 3, "max_length": 3, "process_row": 3, "tokenized_row": 3, "pad_length": 3, "pad_token_id": 3, "attention_mask": 3, "token_type_id": 3, "shuffl": 3, "all_act": 3, "mlp_activations_64bs_512l_minipile1024_gelu1l": 3, "pkl": 3, "get_loss": 3, "l1_coeff": 3, "006": 3, "rec_loss": 3, "l1_loss": 3, "ab": 3, "rand_indic": 3, "randperm": [3, 5], "n_epoch": 3, "adam": 3, "loss": [3, 4, 5], "n_batch": 3, "epoch_loss": 3, "i_batch": 3, "backward": [3, 5], "zero_grad": [3, 5], "all_loss": 3, "log_x": 3, "test_features_roundtrip": 3, "max_ratio": 3, "mean_ratio": 3, "square_ratio": 3, "test_feature_index": 3, "test_featur": 3, "unsqueeze_": 3, "test_mlp_activ": 3, "encoded_featur": 3, "hook": 3, "0430": 3, "pt": 3, "unsqueez": 3, "feat": 3, "input_str": 3, "hello": 3, "input_str_token": 3, "mlp_act": 3, "sae_feat": 3, "mlp_acts_reconstruct": 3, "save_mlp_acts_hook": 3, "sae_reconstruction_hook": 3, "flat_valu": 3, "flat_sae_feat": 3, "reshaped_sae_feat": 3, "flat_mlp_acts_reconstruct": 3, "reshaped_mlp_acts_reconstruct": 3, "logits_sa": 3, "run_with_hook": 3, "fwd_hook": 3, "get_top_token": 3, "sorted_logit": 3, "sorted_ind": 3, "descend": 3, "top_token": 3, "seq_po": 3, "pos_top_token": 3, "pos_top_tokens_decod": 3, "top_k_ind": 3, "top_tokens_orig": 3, "top_tokens_recon": 3, "compare_top_token": 3, "top_k_orig": 3, "top_k_recon": 3, "torigin": 3, "treconstruct": 3, "get_crossentropi": 3, "crossentropi": 3, "cross_entropi": 3, "target": 3, "saebaselin": 3, "dataclass": 3, "saeactivationtrack": 3, "reconstruction_hook": 3, "acts_reconstruct": 3, "get_act_ms": 3, "mse_loss": 3, "run_with_sa": 3, "sae_act_track": 3, "hook_fn": 3, "run_test_input": 3, "input_text": 3, "ep": 3, "0000001": 3, "d_sae": 3, "def_input_text": 3, "eval_sae_single_input": 3, "activation_ms": 3, "mse": [3, 5], "eval_sae_batch": 3, "256": 3, "load_sample_training_dataset": 3, "eval_dataload": 3, "act_ms": 3, "parametr": 3, "saetrainingarg": 3, "lr": [3, 5], "001": 3, "2048": 3, "sae_init_rang": 3, "saetrain": 3, "arg": [3, 5], "forward_step": 3, "sae_featur": 3, "sae_input": 3, "i_epoch": 3, "weight": [3, 4], "saedecodernorm": 3, "normalize_decod": 3, "no_grad": [3, 5], "twice": 3, "exp": 3, "sparsiti": 3, "get_features_dens": 3, "threshold": 3, "float32": [3, 5], "densiti": 3, "saetrainermeanreduc": 3, "mean_reduc": 3, "smaller": [3, 7], "l1": 3, "coeff": 3, "0006": 3, "simplest": 3, "00006": 3, "0005": 3, "epoch_rec_loss": 3, "epoch_l1_loss": 3, "itertool": 3, "chain": 3, "plot_loss": 3, "from_iter": 3, "loss_df": 3, "123": 3, "saetrainersamebatch": 3, "000000006": 3, "neuron": 3, "resampl": 3, "saetrainingargsresampl": 3, "resampling_lookback_step": 3, "resample_epoch": 3, "default_factori": 3, "lambda": 3, "other_epoch_resample_batch": 3, "first_epoch_resample_batch": 3, "resample_epsilon": 3, "02": 3, "resample_n_random_act": 3, "resample_encoder_weight_norm_factor": 3, "saetrainerresampl": 3, "features_buffer_s": 3, "features_buff": 3, "epochs_train": 3, "update_features_buff": 3, "get_dead_neuron_ind": 3, "neurons_off": 3, "dead_neuron": 3, "dead_neuron_ind": 3, "argwher": 3, "alive_neuron": 3, "alive_neuron_ind": 3, "get_random_act": 3, "random_act": 3, "get_random_act_prob": 3, "sq_loss": 3, "prob": 3, "sample_act": 3, "random_act_prob": 3, "n_dead_neuron": 3, "sample_ind": 3, "multinomi": 3, "num_sampl": 3, "set_dead_neuron_weight": 3, "sampled_act": 3, "avg_alive_neuron_l2": 3, "sampled_acts_l2": 3, "sampled_acts_norm": 3, "encoder_weight": 3, "resample_dead_neuron": 3, "was_train": 3, "dead": 3, "40000": 3, "600": [3, 4, 5], "saelen": 3, "sae_len": 3, "cfg_dict": 3, "releas": 3, "gpt2": 3, "jb": 3, "sae_id": 3, "hook_resid_pr": 3, "tokenize_and_concaten": 3, "neelnanda": 3, "pile": 3, "10k": 3, "token_dataset": 3, "context_s": 3, "add_bos_token": 3, "prepend_bo": 3, "test_input": 3, "ann": 3, "went": 3, "hike": 3, "gave": 3, "stick": 3, "test_answ": 3, "test_prompt": 3, "to_token": 3, "sae_out": 3, "hook_nam": 3, "endoftext": 3, "rank": 3, "17": 3, "22": 3, "1th": 3, "01": 3, "03": 3, "2th": 3, "89": 3, "3th": 3, "81": 3, "him": 3, "4th": 3, "5th": 3, "6th": 3, "96": 3, "91": 3, "7th": 3, "76": 3, "75": 3, "pete": 3, "8th": 3, "38": 3, "51": 3, "9th": 3, "19": 3, "model_act": 3, "sae_act": 3, "sae_acts_fin": 3, "116": 3, "4617": 3, "grad_fn": 3, "sumbackward0": 3, "get_sae_featur": 3, "describe_final_act": 3, "l0": 3, "l0_norm": 3, "top_acts_ind": 3, "argsort": 3, "plot_final_sae_act": 3, "test_input_text": 3, "83": 3, "61": 3, "55": [3, 5], "62": 3, "77": 3, "73": 3, "26": 3, "72": 3, "71": 3, "21": 3, "161": 3, "46652221679688": 3, "24272": 3, "3962": 3, "9706": 3, "6863": 3, "9926": 3, "6646": 3, "5244": 3, "7914": 3, "13959": 3, "21205": 3, "21043": 3, "20630": 3, "13660": 3, "22094": 3, "22670": 3, "great": [3, 4], "h": [3, 5], "ik": 3, "45": 3, "34": 3, "99": 3, "68": 3, "59": 3, "69": 3, "86": 3, "60": [3, 4], "84": 3, "63345336914062": 3, "13276": 3, "21336": 3, "6082": 3, "5139": 3, "24559": 3, "4517": 3, "20593": 3, "4637": 3, "15886": 3, "14780": 3, "19293": 3, "8888": 3, "9881": 3, "5038": 3, "small_dataset_train": 3, "select": 3, "small_dataset_test": 3, "raw_dataset": 3, "glue": 3, "mrpc": 3, "choic": [3, 4], "tokenize_funct": 3, "tokenized_dataset_train": 3, "tokenized_dataset_test": 3, "data_col": 3, "helloooooo": 3, "collat": 3, "wandb_mod": 3, "disabl": 3, "wb": 3, "predicted_token": 3, "188": 3, "39": 3, "test_feature_to_max": 3, "mlp_out": 3, "token_ind": 3, "get_dataset": 3, "original_architectur": 3, "openai_secret_kei": 4, "openai": 4, "api": 4, "api_kei": 4, "client": 4, "biased_prompt": 4, "better": 4, "pet": 4, "respons": 4, "chat": 4, "turbo": 4, "messag": 4, "system": 4, "briefli": 4, "prefer": 4, "lifestyl": 4, "answer_quest": 4, "vari": 4, "aim": 4, "preview": 4, "biased_quest": 4, "obviou": 4, "benefici": 4, "diet": 4, "agre": 4, "electr": 4, "car": 4, "combat": 4, "climat": 4, "onlin": 4, "tradit": 4, "classroom": 4, "educ": 4, "remot": 4, "offic": 4, "smartphon": 4, "distract": 4, "organ": 4, "food": 4, "healthier": 4, "social": 4, "media": 4, "mental": 4, "health": 4, "public": 4, "transport": 4, "drive": 4, "renew": 4, "sourc": 4, "reliabl": 4, "fossil": 4, "fuel": 4, "watch": 4, "tv": 4, "Not": 4, "subject": 4, "ultim": 4, "whether": 4, "due": 4, "independ": [4, 5], "favor": 4, "loyalti": 4, "activ": [4, 5], "companionship": 4, "mainten": 4, "companion": 4, "maintain": 4, "sociabl": 4, "wonder": [4, 5], "appreci": 4, "suitabl": 4, "busi": 4, "provid": 4, "engag": 4, "benefit": 4, "challeng": 4, "schedul": 4, "train": [4, 5], "connect": 4, "advantag": 4, "bring": 4, "joi": 4, "owner": 4, "gain_fram": 4, "imagin": [4, 5], "prepar": 4, "outbreak": 4, "diseas": 4, "kill": 4, "program": 4, "adopt": 4, "choos": [4, 5], "loss_fram": 4, "die": 4, "nobodi": 4, "get_respons": 4, "appropri": 4, "max_token": 4, "150": 4, "gain_respons": 4, "loss_respons": 4, "gain": 4, "script": 4, "govern": 4, "protect": 4, "endang": 4, "wildlif": 4, "speci": 4, "900": 4, "extinct": 4, "custom": 4, "risk": 4, "guarante": 4, "live": 4, "death": 4, "citi": 4, "plan": 4, "traffic": 4, "congest": 4, "campaign": 4, "smoke": 4, "polici": 4, "40": 4, "smoker": 4, "half": 4, "disast": 4, "relief": 4, "effort": 4, "water": 4, "strategi": 4, "fourth": 4, "2000": 4, "1500": [4, 5], "student": 4, "fifth": 4, "80": 4, "conserv": 4, "forest": 4, "acr": 4, "tenth": 4, "1000": [4, 5], "healthcar": 4, "diabet": 4, "compani": 4, "employe": 4, "satisfact": 4, "report": 4, "dissatisfi": 4, "workplac": 4, "accid": 4, "prevent": 4, "market": 4, "sale": 4, "doubl": 4, "crime": 4, "90": 4, "uncertainti": 4, "binari": 4, "uncertain": 4, "success": 4, "overal": 4, "safer": 4, "bet": 4, "among": 4, "reduct": 4, "growth": 4, "dimension": 5, "x_1": 5, "x_2": 5, "uniformli": 5, "def_n_point": 5, "def_n_featur": 5, "def_spars": 5, "generate_data": 5, "n_point": 5, "n_featur": 5, "unuformli": 5, "x_i": 5, "sparsity_mask": 5, "rand": 5, "plot_data": 5, "opac": 5, "width": 5, "height": 5, "title_text": 5, "sub": 5, "send": 5, "bandwidth": 5, "someon": 5, "put": 5, "formal": 5, "mathbb": 5, "denot": 5, "chosen": 5, "l_": 5, "throw": 5, "addit": [5, 7], "constraint": 5, "must": 5, "wx": 5, "w_1": 5, "w_2": 5, "affin": 5, "substitut": 5, "term": 5, "composit": 5, "rewritten": 5, "translat": 5, "b_h": 5, "b_y": 5, "b_c": 5, "absorb": 5, "subplot": 5, "make_subplot": 5, "plot_map": 5, "margin": 5, "h_flat": 5, "w_vec": 5, "w_str": 5, "2f": 5, "b_vec": 5, "b_str": 5, "subtitl": 5, "x_np": 5, "y_np": 5, "x_range_0": 5, "x_range_1": 5, "x_lim_0": 5, "x_lim_1": 5, "y_range_0": 5, "y_range_1": 5, "y_lim_0": 5, "y_lim_1": 5, "col": 5, "subplot_titl": 5, "spec": 5, "horizontal_spac": 5, "dict": 5, "colorscal": 5, "showscal": 5, "w_normal": 5, "arrow_scal": 5, "add_annot": 5, "xref": 5, "x1": 5, "yref": 5, "y1": 5, "axref": 5, "ayref": 5, "showarrow": 5, "arrowhead": 5, "arrows": 5, "arrowwidth": 5, "arrowcolor": 5, "xanchor": 5, "yanchor": 5, "bottom": 5, "xshift": 5, "yshift": 5, "font": 5, "colorbar": 5, "x3": 5, "y3": 5, "showticklabel": 5, "main_titl": 5, "visual": 5, "full_titl": 5, "1400": 5, "dtype": 5, "descent": 5, "get_devic": 5, "def_input_dim": 5, "def_hidden_dim": 5, "def_import": 5, "def_lr": 5, "def_num_epoch": 5, "linearmap": 5, "xavier_normal_": 5, "zeros_": 5, "compute_hidden": 5, "compute_output": 5, "compute_loss": 5, "train_eval_split": 5, "num_epoch": 5, "sample_fract": 5, "x_shuffl": 5, "n_train": 5, "x_train": 5, "x_eval": 5, "n_sampl": 5, "sample_indic": 5, "x_sampl": 5, "eval_loss": 5, "y_sampl": 5, "y_pred": 5, "y_sample_pr": 5, "y_eval_pr": 5, "plot_training_dashboard": 5, "frame_step": 5, "is_cuda": 5, "input_color": 5, "output_color": 5, "connection_color": 5, "background_color": 5, "eval_step": 5, "all_mins_x": 5, "all_maxs_x": 5, "all_mins_i": 5, "all_maxs_i": 5, "w_val": 5, "b_val": 5, "y_sample_step": 5, "y_sample_np": 5, "linalg": 5, "x_sample_step_calc": 5, "x_sample_np_calc": 5, "all_points_x": 5, "all_points_i": 5, "global_min_x": 5, "global_max_x": 5, "global_min_i": 5, "global_max_i": 5, "global_min": 5, "global_max": 5, "global_rang": 5, "axis_lim": 5, "x_sample_step": 5, "x_sample_np": 5, "line_extend": 5, "line_start": 5, "line_end": 5, "connection_lines_x": 5, "connection_lines_i": 5, "frame_data": 5, "dash": 5, "legendgroup": 5, "x2": 5, "y2": 5, "symbol": 5, "circl": 5, "frame_annot": 5, "column_width": 5, "x_sample_0": 5, "y_sample_0": 5, "x_sample_0_np": 5, "y_sample_0_np": 5, "connection_lines_x_0": 5, "connection_lines_y_0": 5, "w_0": 5, "b_0": 5, "w_0_vec": 5, "w_0_str": 5, "b_0_str": 5, "x\u2081": 5, "x\u2082": 5, "scaleanchor": 5, "scaleratio": 5, "title_i": 5, "92": 5, "hovermod": 5, "closest": 5, "legend": 5, "95": 5, "updatemenu": 5, "method": 5, "durat": 5, "redraw": 5, "fromcurr": 5, "2500": 5, "relumodel": 5, "avail": 6, "jupyt": 6, "collect": [6, 7], "document": [6, 7], "research": 6, "acquaint": [6, 7], "pedagog": [6, 7], "anyon": [6, 7], "fit": [6, 7], "distant": [6, 7], "practition": [6, 7], "deeper": [6, 7], "insid": [6, 7], "mech": [6, 7], "interp": [6, 7], "defeat": [6, 7], "spend": [6, 7], "share": [6, 7], "account": [6, 7], "mechan": [6, 7], "site": 7, "frequenc": 7, "analysi": 7, "fourier": 7, "superposit": 7, "klara": 7, "sun": 7}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"frequenc": [0, 1], "domain": 0, "analysi": 0, "fourier": [0, 1], "transform": [0, 3], "setup": [0, 1], "introduct": [0, 1], "1d": 0, "defin": 0, "basi": [0, 1], "cosin": 0, "sine": 0, "term": [0, 1], "A": [0, 5], "side": 0, "note": 0, "round": 0, "down": 0, "n": 0, "2": [0, 3], "calcul": 0, "music": 0, "exampl": 0, "2d": 0, "conclus": [0, 1], "grokk": 1, "modular": 1, "addit": 1, "motiv": 1, "what": 1, "i": 1, "The": 1, "task": 1, "load": 1, "model": [1, 3, 5], "visual": 1, "curv": 1, "look": 1, "around": 1, "everyth": 1, "period": 1, "us": 1, "input": 1, "space": 1, "insid": 1, "explor": 1, "pattern": 1, "algorithm": 1, "ha": 1, "learn": 1, "find": 1, "kei": 1, "intervent": 1, "doe": 1, "work": 1, "better": 1, "we": 1, "onli": 1, "keep": 1, "from": [1, 3], "quadrat": 1, "sum": 1, "angl": 1, "trig": 1, "put": 1, "all": 1, "togeth": 1, "summari": 1, "do": 1, "how": 1, "did": 1, "out": 1, "happen": 1, "dure": 1, "train": [1, 3], "evolut": 1, "loss": 1, "embed": 1, "impact": 1, "logit": 1, "neuron": 1, "activ": [1, 3], "develop": 1, "commut": 1, "lag": 1, "between": 1, "test": 1, "clean": 1, "up": 1, "nois": 1, "weight": 1, "magnitud": 1, "klara": 2, "sun": 2, "spars": 3, "autoencod": 3, "superposit": [3, 5], "mondai": 3, "4": 3, "29": 3, "24": 3, "tuesdai": 3, "30": 3, "thursdai": 3, "5": 3, "6": 3, "7": 3, "wednesdai": 3, "8": 3, "16": 3, "fridai": 3, "14": 3, "messi": 3, "here": 3, "hf": 3, "dataset": 3, "gelu": 3, "sae": 3, "gener": 3, "plug": 3, "cognit": 4, "bias": 4, "llm": 4, "even": 5, "smaller": 5, "naiv": 5, "linear": 5, "map": 5, "sparsiti": 5, "relu": 5, "mechanist": 7, "interpret": 7, "notebook": 7, "fundament": 7, "research": 7, "reproduct": 7, "thought": 7, "essai": 7}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 60}, "alltitles": {"Frequency-Domain Analysis and Fourier Transforms": [[0, "frequency-domain-analysis-and-fourier-transforms"]], "Setup": [[0, "setup"], [1, "setup"]], "Introduction: the Fourier transform and the frequency domain": [[0, "introduction-the-fourier-transform-and-the-frequency-domain"]], "Frequency analysis in 1D": [[0, "frequency-analysis-in-1d"]], "Defining a basis of cosine and sine terms": [[0, "defining-a-basis-of-cosine-and-sine-terms"]], "A side-note on rounding down N//2": [[0, "a-side-note-on-rounding-down-n-2"]], "Calculating the 1D Fourier transform": [[0, "calculating-the-1d-fourier-transform"]], "A musical example": [[0, "a-musical-example"]], "Frequency analysis in 2D": [[0, "frequency-analysis-in-2d"]], "Conclusion": [[0, "conclusion"]], "Grokking Modular Addition": [[1, "grokking-modular-addition"]], "Introduction": [[1, "introduction"]], "Motivation: what is \u201cgrokking\u201d?": [[1, "motivation-what-is-grokking"]], "The task: grokking modular addition": [[1, "the-task-grokking-modular-addition"]], "Loading the model": [[1, "loading-the-model"]], "Visualizing the grokking curve": [[1, "visualizing-the-grokking-curve"]], "Looking around: everything is periodic!": [[1, "looking-around-everything-is-periodic"]], "Using the input space to look inside the model": [[1, "using-the-input-space-to-look-inside-the-model"]], "Using the Fourier basis to explore periodic patterns": [[1, "using-the-fourier-basis-to-explore-periodic-patterns"]], "What algorithm has the model learned?": [[1, "what-algorithm-has-the-model-learned"]], "Finding key frequencies": [[1, "finding-key-frequencies"]], "Intervention: does the model work better if we only keep the key frequencies?": [[1, "intervention-does-the-model-work-better-if-we-only-keep-the-key-frequencies"]], "From quadratic Fourier terms to sums of angles": [[1, "from-quadratic-fourier-terms-to-sums-of-angles"]], "Intervention: does the model work better if we only keep the trig terms?": [[1, "intervention-does-the-model-work-better-if-we-only-keep-the-trig-terms"]], "Putting it all together: the modular addition algorithm": [[1, "putting-it-all-together-the-modular-addition-algorithm"]], "Summary: what is the model doing, and how did we find out?": [[1, "summary-what-is-the-model-doing-and-how-did-we-find-out"]], "Grokking: What happens during training?": [[1, "grokking-what-happens-during-training"]], "Evolution of loss": [[1, "evolution-of-loss"]], "Evolution of embeddings": [[1, "evolution-of-embeddings"]], "Evolution of trig term impact on logits and neurons": [[1, "evolution-of-trig-term-impact-on-logits-and-neurons"]], "Evolution of key frequency and trig term impact on neuron activations": [[1, "evolution-of-key-frequency-and-trig-term-impact-on-neuron-activations"]], "Development of commutativity": [[1, "development-of-commutativity"]], "Lag between trig and test loss\u2014cleaning up noise?": [[1, "lag-between-trig-and-test-losscleaning-up-noise"]], "Evolution of weight magnitude": [[1, "evolution-of-weight-magnitude"]], "Conclusions": [[1, "conclusions"]], "Klara and the Sun": [[2, "klara-and-the-sun"]], "Sparse Autoencoders & Superposition": [[3, "sparse-autoencoders-superposition"]], "Monday 4/29/24": [[3, "monday-4-29-24"]], "Tuesday 4/30/24": [[3, "tuesday-4-30-24"]], "Thursday 5/2/24": [[3, "thursday-5-2-24"]], "Monday 5/6/24": [[3, "monday-5-6-24"]], "Tuesday 5/7/24": [[3, "tuesday-5-7-24"]], "Wednesday 5/8/24": [[3, "wednesday-5-8-24"]], "Thursday 5/16/24": [[3, "thursday-5-16-24"]], "Friday 6/14/24": [[3, "friday-6-14-24"]], "Messy from here on": [[3, "messy-from-here-on"]], "HF dataset": [[3, "hf-dataset"]], "GELU Model": [[3, "gelu-model"]], "SAE": [[3, "sae"]], "Generating activation dataset": [[3, "generating-activation-dataset"]], "Training": [[3, "training"]], "Plugging SAE into transformer": [[3, "plugging-sae-into-transformer"]], "Cognitive biases in LLMs": [[4, "cognitive-biases-in-llms"]], "Even Smaller Models of Superposition": [[5, "even-smaller-models-of-superposition"]], "A naive linear mapping": [[5, "a-naive-linear-mapping"]], "Sparsity": [[5, "sparsity"]], "ReLU Model": [[5, "relu-model"]], "Mechanistic Interpretability Notebooks": [[7, "mechanistic-interpretability-notebooks"]], "Fundamentals": [[7, null]], "Research Reproductions": [[7, null]], "Thoughts & Essays": [[7, null]]}, "indexentries": {}})